---
title: "Modeling and Prediction for Movies"
author: "Rohan Lewis"
date: "06/01/2020"
output: 
  html_document: 
    fig_width: 9
    highlight: pygments
    theme: spacelab
---

```{r, echo = FALSE}
knitr::opts_chunk$set(comment = NA)
options("scipen" = 100)

years <- c(1970, 1975, 1980, 1985, 1990, 1995, 2000, 2005, 2010)
```

```{r load-packages, message = FALSE, echo = FALSE}
library(dplyr)
library(ggplot2)
library(ggpubr)
library(grid)
library(gridExtra)
library(lemon)
library(lindia)
library(scales)
library(statsr)
library(viridis)
```

```{r load-data, echo = FALSE}
load("movies.Rdata")
```

* * *

## Part 1: Data

From the Codebook, ["The data set is comprised of 651 randomly sampled movies produced and released before 2016.".](https://d18ky98rnyall9.cloudfront.net/_73393031e98b997cf2445132f89606a1_movies_codebook.html?Expires=1590537600&Signature=A~dESFNzccSFVj6mqJ8EM32PVLyRGuEN4qIdECKxC1wzzzYnnnxLouKBi-TsjtD48NtXw6LQfKrF4YYW-NkczQfRCmrcZzREDQx28Z6Qv7tXHWl86Cv84py6~0Ng3CzZHciYz1K9vqtOkxalWfsbE7J2M-sd-Wl1PEplIY6mX64_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A)

Because there were no details, I decided to plot a few variables to see how random this sample is.
```{r, echo = FALSE}
#Histogram.
sample_length <- max(movies$thtr_rel_year) - min(movies$thtr_rel_year) + 1
g1 <- ggplot(movies, aes(x = thtr_rel_year, fill = cut(thtr_rel_year, sample_length)))
g1 <- g1 + geom_histogram(bins = sample_length)
#Title.
g1 <- g1 + ggtitle(label = "Distribution by Year of 651 Randomly Sampled Movies")
#Viridis Color Scheme.
g1 <- g1 + scale_fill_viridis_d()
#X-axis.
g1 <- g1 + scale_x_continuous(name = "Theatrical Release Year",
                              breaks = years,
                              labels = years,
                              expand = c(0,0))
#Y-axis.
g1 <- g1 + scale_y_continuous(name = "Number of Movies")
                              
#Modify labels and text. Remove legend from left plot.
g1 <- g1 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                 axis.text.x = element_text(hjust = 1, size = 12, angle = 45),
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"),
                 legend.position = "none")
g1
```

First as we see from above, the distribution of movies is from 1970 - 2014. More movies have been released in recent years, so skewed left is not unexpected.
 
I also took a look at the Oscar categories.  The number of best actor wins (93) and best actress wins (72) is quite high for 651 movies.  This leads me to believe that more well known, heavily advertised, and blockbuster films were more likely to be choosen from the sample.  I would have to investigate the sampling method in more detail to draw a more concrete conclusion, but that is not the purpose of this project.  I merely wanted a more indepth summary of the movies chosen.
 
```{r, echo = FALSE}
summary(movies %>%
          select(best_pic_nom,
                 best_pic_win,
                 best_actor_win,
                 best_actress_win,
                 best_dir_win,
                 top200_box))

```

This was an observational study, as no hypothesis, controls, nor confounding variables were specified beforehand.  We can use this data to generalize and draw some trends in movies of the past 50 years, but not make definitive causal arguments.

* * *

## Part 2: Research question

As someone who has watched many documentaries, movies, and TV shows, I have regularly used [IMDb](https://www.imdb.com) for over 20 years.  I would like to see if the IMDB Rating is reasonably predictable from characteristics of the movie.

I first unselected imdb_url and rt_url, as these are unique and identify the movie.  I then unselected thtr_rel_day, dvd_rel_year dvd_rel_month, and dvd_rel_day.  I think thtr_rel_year and thtr_rel_month would have a greater impact on the number votes.  DVD Release is usually 4 - 12 months after theatrical release, and including both would have collinearity issues.  I next unselected all Rotten Tomatoes variables, that is, critics_rating, critics_score, audience_rating, and audience_score.  Since I am focused on IMDb, I am ignoring the ratings and scores from Rotten Tomatoes.

Finally, I unselected actor1, actor2, actor3, actor4, and actor5.  These would be too difficult to organize and categorize into a linear model, at least for the scope of this class.  I included best_pic_nom, best_pic_win, best_actor_win, best_actress_win, and top200_box, as I think these characteristics would affect the rating.

Using title for identification purposes, the remaining variables are title_type, genre, runtime, mpaa_rating, studio, thtr_rel_year, thtr_rel_month, imdb_rating (dependent variable in this exploration), imdb_num_votes,  best_pic_nom, best_pic_win, best_actor_win, best_actress_win, top200_box and director.

Can the Rating on IMDb be predicted from these variables?

* * *

## Part 3: Exploratory data analysis

Here is a summary of the preliminary variables.
```{r, echo = FALSE}

movies_model <- movies %>% select(title, title_type, genre,
                                  runtime, mpaa_rating, studio,
                                  thtr_rel_year, thtr_rel_month,
                                  imdb_rating, imdb_num_votes,
                                  best_pic_nom, best_pic_win,
                                  best_actor_win, best_actress_win,
                                  top200_box, director)
summary(movies_model)
```

```{r, echo = FALSE}
#Boxplot.
g2 <- ggplot(movies_model, aes(x = genre, y = thtr_rel_year))
g2 <- g2 + geom_boxplot(aes(color = genre), size = 1.3)
#Title.
g2 <- g2 + ggtitle(label = "Distribution of Genres by Year of 651 Randomly Sampled Movies")
#Viridis Color Scheme.
#X-axis.
g2 <- g2 + scale_x_discrete(name = "Genre",
                            expand = c(0,0))
#Y-axis.
g2 <- g2 + scale_y_continuous(name = "Theatrical Release Year")
#Modify labels and text. Remove legend from left plot.
g2 <- g2 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                 axis.text.x = element_text(hjust = 1, size = 10, angle = 45),
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"),
                 legend.position = "none")
g2
```

There seems to be a wide range of genres, and they are distributed reasonably well over the years. I do have some reservations about using Genre, however, as a movie can be of multiple genres. 

```{r, fig.height = 6, echo = FALSE}

summary(movies_model %>%
          select(imdb_num_votes,
                 imdb_rating))

#Scatter plot.
g3 <- ggplot(movies_model %>% filter(imdb_num_votes <= 100000), aes(x = imdb_num_votes, y = imdb_rating))
g3 <- g3 + geom_point(aes(color = thtr_rel_year), size = 5, alpha = 0.5)
#Title.
g3 <- g3 + ggtitle(label = "")
#Viridis Color Scheme.
g3 <- g3 + scale_color_viridis()
#X-axis.
g3 <- g3 + scale_x_continuous(name = "Number of Votes on IMDb",
                              labels = comma,
                              expand = c(0.005,0.005))
#Y-axis.
g3 <- g3 + scale_y_continuous(name = "Rating on IMDb",
                              limits = c(1.9, 9),
                              breaks = c(2, 4, 6, 8),
                              labels = c("2.0", "4.0", "6.0", "8.0"))
#Modify labels and text. Remove legend from left plot.
g3 <- g3 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                 axis.text.x = element_text(hjust = 1, size = 12, angle = 45),
                 axis.title.x = element_text(hjust = 1, size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"),
                 legend.position = "none")


g4 <- ggplot(movies_model %>% filter(imdb_num_votes >= 100000), aes(x = imdb_num_votes, y = imdb_rating))
g4 <- g4 + geom_point(aes(color = thtr_rel_year), size = 5, alpha = 0.5)
#Title.
g4 <- g4  + ggtitle(label = "IMDb Information by Year of 651 Randomly Sampled Movies")
#Viridis Color Scheme.
g4 <- g4  + scale_color_viridis(name = "Theatrical Release Year",
                                limits = c(1970, 2014),
                                breaks = c(1975, 1985, 1995, 2005))
g4 <- g4 + guides(color = guide_colorbar(title.position = "top"))
#X-axis.
g4 <- g4  + scale_x_continuous(name = "",
                              labels = comma,
                              expand = c(0,0)) 
#Y-axis.
g4 <- g4 + scale_y_continuous(name = "", position = "right",
                              limits = c(5, 9.3),
                              breaks = c(6, 8),
                              labels = c("6.0", "8.0"),
                              expand = c(0,0))
#Modify labels and text. Remove legend from left plot.
g4 <- g4  + theme(plot.title = element_text(hjust = 1.25, size = 16, face = "bold"),
                  axis.text.x = element_text(hjust = 1, size = 12, angle = 45),
                  axis.title.x = element_blank(),
                  axis.text.y = element_text(size = 12),
                  axis.title.y = element_blank())
                 

#Modify legend text.  Save as object.
legend3 <- g_legend(g4 + theme(legend.text = element_text(size = 12),
                               legend.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                               legend.key.width = unit(1.5, "cm"),
                               legend.position = "bottom"))
#Remove legend from right plot.
g4 <- g4 + theme(legend.position = "none")
#Arrange left plot, right plot, and legend on the bottom.
grid.arrange(g3, g4, legend3, layout_matrix = matrix(rbind(c(1, 1, 1, 2, 2),
                                                           c(1, 1, 1, 2, 2),
                                                           c(1, 1, 1, 2, 2),
                                                           c(1, 1, 1, 2, 2),
                                                           c(1, 1, 1, 2, 2),
                                                           c(1, 1, 1, NA, NA),
                                                           c(1, 1, 1, 3, 3),
                                                           c(1, 1, 1, NA, NA)),
                                                     ncol = 5))
```

I decided to look at the number of votes and ratings for the movies in the sample.  A range of 1.9 - 9.0, with most in 5.0 - 8.0, is a good representation.  The heavy density on the left and exaggerated right skew of votes is to be expected. 

```{r, fig.height = 4, echo = FALSE, warning = FALSE}
#Studio Tally.
studio_df <- data.frame(movies_model %>% group_by(studio) %>% tally())

#Distribution of Movies by Studio.
g5 <- ggplot(studio_df, aes(x = n)) + geom_histogram(bins = 37, fill = viridis(4)[2])
#Title.
g5 <- g5 + ggtitle("Distribution of 651 Movies by Studio")
#X-axis
g5 <- g5 + scale_x_continuous("Number of Movies by Studio")
#Y-axis.
g5 <- g5 + scale_y_continuous(name = "Frequency of Studios")
#Modify labels and text.
g5 <- g5 + theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                 axis.text.x = element_text(size = 12),
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"))

#Director Tally.
director_df <- data.frame(movies_model %>% group_by(director) %>% tally())

#Distribution of Movies by Director.
g6 <-  ggplot(director_df, aes(x = n)) + geom_histogram(bins = 4, fill = viridis(4)[3])
#Title.
g6 <- g6 + ggtitle("Distribution of 651 Movies by Director")
#X-axis
g6 <- g6 + scale_x_continuous("Number of Movies by Director")
#Y-axis.
g6 <- g6 + scale_y_continuous(name = "Frequency of Directors")
#Modify labels and text.
g6 <- g6 + theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                 axis.text.x = element_text(size = 12),
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"))

grid.arrange(g6, g5, layout_matrix = matrix(rbind(c(1, 1, 1, 1, 1, 1, NA, 2, 2, 2, 2, 2, 2)),
                                            ncol = 13))
```

First, over 400 directors have directed only one movie in our sample.  I am therefore unselecting this variable from the model.

As we can see, over 100 Studios have produce one movie in our sample.  However, many movie studios are repeated by different names in the column.  For example, "20th Century Fox" appears as all of the following:

```{r, echo = FALSE}
movies_model$studio <- as.character(movies_model$studio)

#20th Century Fox Output.
unique(movies_model[grepl("Fox", movies_model$studio),]$studio)
```

There are several others.  For full details in the cleaning, see the Appendix.

After omitting eight movies with no studio, consolidating the different names of the same studio, as well as filtering out studios with only a single movie, the distribution is as follows.  Note that over 400 movies in the original sample were produced by only 11 studios.

```{r, fig.height = 4,  echo = FALSE}
#Studios with repeats.
studios <- c("A24", "Anchor Bay", "Buena Vista", "Embassy", "Gravitas", "HBO", "IFC",
             "Indomina", "Miramax", "National Geographic", "New Line", "Newmarket", "Nordisk",
             "Orion", "Paramount", "Roadside", "Sony", "Touchstone",
             "Trimark", "Universal", "Weinstein")

for (studio_n in studios) {
  movies_model[grepl(studio_n, movies_model$studio),]$studio <- studio_n
}

#Disney/Walt Disney, DreamWorks, 20th Century Fox, LionsGate, MagnetMagnolia, MGM, Warner
movies_model[grepl("Columbia|TriStar", movies_model$studio),]$studio <- "Columbia Tristar Pictures"
movies_model[grepl("Disney", movies_model$studio),]$studio <- "Walt Disney"
movies_model[grepl("Dream", movies_model$studio),]$studio <- "DreamWorks"
movies_model[grepl("Fox", movies_model$studio),]$studio <- "20th Century Fox"
movies_model[grepl("Lions", movies_model$studio),]$studio <- "LionsGate"
movies_model[grepl("Magnet|Magnolia", movies_model$studio),]$studio <- "Magnolia Pictures"
movies_model[grepl("Goldwyn|MGM|UA|United Artists", movies_model$studio),]$studio <- "MGM/UA"
movies_model[grepl("Warner|WARNER", movies_model$studio),]$studio <- "Warner Brothers"

#New Studio Tally and filter.
studio_df <- data.frame(movies_model %>%
                          filter(!(is.na(studio)))  %>%
                          group_by(studio) %>%
                          tally()) %>%
  mutate(studio = as.factor(studio)) %>%
  filter(n >= 2)

#Distribution of Movies by Studio.
g7 <- ggplot(studio_df, aes(x = n)) + geom_histogram(bins = 70, fill = viridis(4)[2])
#Title.
g7 <- g7 + ggtitle("")
#X-axis
g7 <- g7 + scale_x_continuous("")
#Y-axis.
g7 <- g7 + scale_y_continuous(name = "Frequency of Studios")
#Modify labels and text.
g7 <- g7 + theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                 axis.text.x = element_text(size = 12),
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"))

#Distribution of Movies by Studio.
g8 <- ggplot(studio_df %>% filter(n > 15), aes(x = n, y = reorder(studio, n)))
g8 <- g8 + geom_bar(stat = "identity", fill = viridis(4)[1], orientation = "y")
#Title.
g8 <- g8 + ggtitle(paste("Distribution of", sum(studio_df$n), "Movies by Studio"))
#X-axis
g8 <- g8 + scale_x_continuous(name = "Number of Movies by Studio")
#Y-axis.
#g8 <- g8 + scale_y_discrete("Studios")
#Modify labels and text.
g8 <- g8 + theme(plot.title = element_text(hjust = -2.9, size = 14, face = "bold"),
                 axis.text.x = element_text(size = 12), 
                 axis.title.x = element_text(hjust = -1.25, size = 14, face = "bold"),
                 axis.text.y = element_text(hjust = 1, size = 12, angle = 25),
                 axis.title.y = element_blank())

grid.arrange(g7, g8, layout_matrix = matrix(rbind(c(1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2)),
                                            ncol = 13))

```

* * *

## Part 4: Modeling

### Variables for Model:

Currently the predictors being considered for IMDb Rating are:

```{r, echo = FALSE}
movies_model <- movies_model %>%
  filter(studio %in% studio_df$studio) %>%
  select(c(9, 2:8, 10:15))

colnames(movies_model)[2:13]
```

See the Appendix for model details.

```{r, echo = FALSE}
#Regression model with all preliminary variables.
prelim_reg <-summary(lm(imdb_rating ~ title_type + genre + runtime + mpaa_rating + thtr_rel_year
                        + thtr_rel_month + studio + imdb_num_votes + best_pic_nom + best_pic_win
                        + best_actor_win + best_actress_win + top200_box + studio,
                        data = movies_model))

#R-Squared.
rs <- round(prelim_reg$r.squared, 4)
#F-Statistic
fstat <- prelim_reg$fstatistic
#p-Value.
pVal <- round(pf(fstat[1], fstat[2], fstat[3], lower.tail = FALSE), 4)

print(paste("The R-Squared from the above variables is", rs, "."))
print(paste("The F-Statistic from the above variables is", round(fstat[1], 1), "."))
print(paste("The p-Value from the above F-Statistic on",
            round(fstat[2], 1), "and",
            round(fstat[3], 1), "degrees of freedom is ~", pVal, "."))
```

### Hypotheses:

H<sub>0</sub> : The slopes of all variables are zero for the regression model.

H<sub>A</sub> : At least one slope is different from 0. 

Since the p-value < 0.05 from the F test above, we reject H<sub>0</sub>.

### Model Selection Choice:

I will be using the forward selection method, selecting predictors by their adjusted R<sup>2</sup>.  I am choosing this method as a reliable overall prediction model is my priority.  I am not as concerned about the significance of the individual predictors.

### Model Selection Process:

```{r, message = FALSE, echo = FALSE}
#Selection 1.
Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(2:14)]) {
  Predictors <- c(Predictors, x)
  temp_df <- movies_model %>%
    select(imdb_rating, x) %>%
    `colnames<-`(c("imdb_rating", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

The first round of selection yields genre as having the highest adjusted R<sup>2</sup>, which is 0.20589.

```{r, echo = FALSE}
#Selection 2.
movies_model <- movies_model %>%
  select(1, 3, 2, 4:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(3:14)]) {
  Predictors <- c(Predictors, paste("genre + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

The second round of selection yields genre + imdb_num_votes as having the highest adjusted R<sup>2</sup>, which is 0.36307.

```{r, echo = FALSE}
#Selection 3.
movies_model <- movies_model %>%
  select(1, 2, 9, 3:8, 10:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(4:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

The third round of selection yields genre + imdb_num_votes + mpaa_rating as having the highest adjusted R<sup>2</sup>, which is 0.38693.

```{r, echo = FALSE}
#Selection 4.
movies_model <- movies_model %>%
  select(1:3, 6, 4, 5, 7:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(5:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

The fourth round of selection yields genre + imdb_num_votes + mpaa_rating + thtr_rel_year as having the highest adjusted R<sup>2</sup>, which is 0.40332.

```{r, echo = FALSE}
#Selection 5.
movies_model <- movies_model %>%
  select(1:4, 8, 5:7, 9:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(6:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year" , "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

The fifth round of selection yields genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type as having the highest adjusted R<sup>2</sup>, which is 0.41242.

```{r, echo = FALSE}
#Selection 6.
#No change in order.

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(7:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, title_type,
           x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year", "title_type",
                   "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type +
                         depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

The sixth round of selection yields genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type + runtime as having the highest adjusted R<sup>2</sup>, which is 0.41964.

```{r, echo = FALSE}
#Selection 7.
#No change in order.

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(8:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, title_type,
           runtime, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year", "title_type",
                   "runtime", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type +
                         runtime + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

The seventh round of selection yields genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type + runtime + best_pic_nom as having the highest adjusted R<sup>2</sup>, which is 0.42216.

```{r, echo = FALSE}
#Selection 8.
movies_model <- movies_model %>%
  select(1:7, 10, 8, 9, 11:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(9:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, title_type,
           runtime, best_pic_nom, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year", "title_type",
                   "runtime", "best_pic_nom", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type +
                         runtime + best_pic_nom + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

The eight round of selection yields genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type + runtime + best_pic_nom + best_pic_win as having the highest adjusted R<sup>2</sup>, which is 0.42381.

```{r, echo = FALSE}
#Selection 8.
movies_model <- movies_model %>%
  select(1:8, 11, 9, 10, 12:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(10:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, title_type,
           runtime, best_pic_nom, best_pic_win, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year", "title_type",
                   "runtime", "best_pic_nom", "best_pic_win", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type +
                         runtime + best_pic_nom + best_pic_win + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

The ninth round of selection yields genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type + runtime + best_pic_nom + best_pic_win + studio as having the highest adjusted R<sup>2</sup>, which is 0.42485.

```{r, echo = FALSE}
#Selection 9.
#No change in order.

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(11:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, title_type,
           runtime, best_pic_nom, best_pic_win, studio, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year", "title_type",
                   "runtime", "best_pic_nom", "best_pic_win", "studio", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type +
                         runtime + best_pic_nom + best_pic_win + studio + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

No additional predictor variable is a satisfactory explantory variable, as every adjusted R<sup>2</sup> value is less than 0.42485.

### Model diagnostics

#### Linear Relationships Between x and y

The three numerical explanatory variables included in the model are imdb_num_votes, thtr_rel_year, and runtime.

```{r, message = FALSE, echo = FALSE}
final_model <- movies_model %>%
  select(1:10)

#Regression Model.
final_reg <- lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type
                + runtime + best_pic_nom + best_pic_win + studio,
                data = movies_model)

#Scatter of Residual Values vs IMDB Number of Votes.
g9 <- ggplot(final_reg, aes(x = imdb_num_votes, y = .resid))
g9 <- g9 + geom_point(color = viridis(5)[3], size = 3, alpha = 0.2)
#Horizontal line at y = 0.
g9 <- g9 + geom_hline(yintercept = 0, col = viridis(5)[1], linetype = "dashed")
#Title.
g9 <- g9 + ggtitle("Residual Values vs Votes")
#X-axis & Y-axis.
g9 <- g9 + scale_x_continuous("IMDB Number of Votes", labels = comma) + ylab("Residual Value")
#Modify labels and text.
g9 <- g9 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                 axis.text.x = element_text(size = 12), 
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"))

#Scatter of Residual Values vs Theatrical Release Year.
g10 <- ggplot(final_reg, aes(x = thtr_rel_year , y = .resid))
g10 <- g10 + geom_point(color = viridis(5)[3], size = 3, alpha = 0.2)
#Horizontal line at y = 0.
g10 <- g10 + geom_hline(yintercept = 0, col = viridis(5)[1], linetype = "dashed")
#Title.
g10 <- g10 + ggtitle("Residual Values vs Year")
#X-axis & Y-axis.
g10 <- g10 + xlab("Theatrical Release Year") + ylab("Residual Value")
#Modify labels and text.
g10 <- g10 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                  axis.text.x = element_text(size = 12), 
                  axis.title.x = element_text(size = 14, face = "bold"),
                  axis.text.y = element_text(size = 12),
                  axis.title.y = element_text(size = 14, face = "bold"))

#Scatter of Residual Values vs Runtime of Movie.
g11 <- ggplot(final_reg, aes(x = runtime, y = .resid))
g11 <- g11 + geom_point(color = viridis(5)[3], size = 3, alpha = 0.2)
#Horizontal line at y = 0.
g11 <- g11 + geom_hline(yintercept = 0, col = viridis(5)[1], linetype = "dashed")
#Title.
g11 <- g11 + ggtitle("Residual Values vs Runtime")
#X-axis & Y-axis.
g11 <- g11 + xlab("Runtime of Movie (minutes)") + ylab("Residual Value")
#Modify labels and text.
g11 <- g11 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                  axis.text.x = element_text(size = 12), 
                  axis.title.x = element_text(size = 14, face = "bold"),
                  axis.text.y = element_text(size = 12),
                  axis.title.y = element_text(size = 14, face = "bold"))

grid.arrange(g9, g10, g11, layout_matrix = matrix(rbind(c(1, 1, 2, 2),
                                                        c(NA, 3, 3, NA)),
                                                  ncol = 4))
```

For Number of IMDB Votes, the residuals seem to be randomly scattered around 0.  As noted above, the heavy density on the left and exaggerated right skew of votes is to be expected.  For Theatrical Release Year, the residuals are randomly scattered around 0.  I do not know for sure whether to treat year as numerical or categorical, so I included it anyway.  Finally for Runtime, the plot shows a random scatter around 0 for the vast majority of movies, that is movies between 90 - 150 minutes long.

#### Nearly Normal Residuals

```{r, fig.height = 4, message = FALSE, echo = FALSE}
#Histogram
g12 <- ggplot(mapping = aes(x = final_reg$residuals)) + geom_histogram(bins = 20, fill = viridis(5)[3])
#Title.
g12 <- g12 + ggtitle("Distribution of Residual Values")
#X-axis & Y-axis.
g12 <- g12 + xlab("Residual Value") + ylab("Frequency")
#Modify labels and text.
g12 <- g12 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                   axis.text.x = element_text(size = 12), 
                   axis.title.x = element_text(size = 14, face = "bold"),
                   axis.text.y = element_text(size = 12),
                   axis.title.y = element_text(size = 14, face = "bold"))

#QQLine
res = final_reg$residuals
m = (quantile(res, 0.75) - quantile(res, 0.25)) / (qnorm(0.75) - qnorm(0.25))
b = quantile(res, .25) - m * qnorm(0.25)
qq_line = data.frame(intercept = b,
                     slope = m)

#Normal-QQ Plot
g13 <- ggplot(data = final_reg)
g13 <- g13 + stat_qq(aes(sample = res), color = viridis(5)[3], size = 3, alpha = 0.4)
g13 <- g13 + geom_abline(data = qq_line ,aes(intercept = b, slope = m), color = viridis(5)[1], size = 1)
#Title.
g13 <- g13 + ggtitle("Normal-QQ Plot")
#X-axis & Y-axis.
g13 <- g13 + xlab("Theoretical Quantile") + ylab("Standardized Residual")
#Modify labels and text.
g13 <- g13 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                   axis.text.x = element_text(size = 12), 
                   axis.title.x = element_text(size = 14, face = "bold"),
                   axis.text.y = element_text(size = 12),
                   axis.title.y = element_text(size = 14, face = "bold"))

grid.arrange(g12, g13, layout_matrix = matrix(c(1, 2),
                                              ncol = 2))
```

There is a slight left skew, but the majority of the residuals fit a normal distribution.

#### Constant Variability of Residuals

```{r, fig.height = 4, message = FALSE, echo = FALSE}
#Scatter of Residuals vs. Fitted.
#Scatter of Residuals vs. Fitted.
g14 <- ggplot(final_reg, aes(x = .fitted, y = .resid))
g14 <- g14 + geom_point(color = viridis(5)[3], size = 3, alpha = 0.4)
#Horizontal Line.
g14 <- g14 + geom_hline(yintercept = 0, col = viridis(5)[1], linetype = "dashed")
#Title.
g14 <- g14 + ggtitle("Residual vs Fitted Values")
#X-axis & Y-axis.
g14 <- g14 + xlab("Fitted Value") + ylab("Residual Value")
#Modify labels and text.
g14 <- g14 + theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                   axis.text.x = element_text(size = 12), 
                   axis.title.x = element_text(size = 14, face = "bold"),
                   axis.text.y = element_text(size = 12),
                   axis.title.y = element_text(size = 14, face = "bold"))

#Scatter of Absolute Value of Residuals vs. Fitted.
g15 <- ggplot(final_reg, aes(x = .fitted, y = abs(.resid)))
g15 <- g15 + geom_point(color = viridis(5)[3], size = 3, alpha = 0.4)
#Horizontal Line.
g15 <- g15 + geom_hline(yintercept = 0, col = viridis(5)[1], linetype = "dashed")
#Title.
g15 <- g15 + ggtitle("Absolute Value of Residuals vs Fitted Values")
#X-axis & Y-axis.
g15 <- g15 + xlab("Fitted Value") + ylab("Absolute Value of Residual")
#Modify labels and text.
g15 <- g15 + theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                   axis.text.x = element_text(size = 12), 
                   axis.title.x = element_text(size = 14, face = "bold"),
                   axis.text.y = element_text(size = 12),
                   axis.title.y = element_text(size = 14, face = "bold"))

grid.arrange(g14, g15, layout_matrix = matrix(c(1, 2),
                                              ncol = 2))
```

From both plots, it is clear there are about 10 - 15 fitted values whose residuals deviate from the others.  Considering this is approximately 1.8 - 2.7% of the data in the model, the residuals seem to be of constant variability.

#### Independence of Residuals

We do not know the exact method or sampling, nor the order in which the movies were chosen, but the movies selected, and thus residuals, appear to be independent of one another.

### Interpretation of Model Coefficients

For full details of the final regression model, see the Appendix.

The intercept of the regression model is 33.46, which would be the IMDb Rating of a movie that :
1) is of genre Action & Adventure,
2) received 0 votes on IMDb,
3) is rated G,
4) was released in theaters in year 0,
5) is a Documentary,
6) is 0 minutes long,
7) has not been nominated nor won the Best Picture,
8) and was produced by A24.

There are 10 genre coefficients, which would be expected to change the IMDB Rating from -0.05 (Animation) to +1.37 (Musical & Performing Arts).

For every 1,000 people that vote for the movie, the expected change to the IMDB Rating would be +0.0036.  If 400,000 people vote for a movie, for example, the expected change to the IMDb Rating would be +1.44.

There are 4 MPAA rating coefficients, which would be expected to change the IMDB Rating from -0.62 (PG-13) to -0.18 (Unrated).

For each year the movie is released in theaters after year 0, the expected change to the IMDb Rating would be -0.0136.  A movie released in 1980, for example, would be expected to change the IMDb Rating by -26.9.

For each minute of runtime of the movie, the expected change to the IMDb Rating would be +0.006487.  A 120 minute movie, for example, would be expected to change the IMDb Rating by +0.78.

There are two additional title types.  The vast majority of movies are Feature Films, which would be expected to change the IMDb Rating by -1.04.  TV Movies would be expected to change the IMDb Rating by +0.15.

If a movie has received a Best Picture Nomination, the expected change to the IMDb Rating would be +0.45.

If a movie has won the Best Picture, the expected change to the IMDb Rating would be -0.69.

There are 47 studio coefficients, which would be expected to change the IMDB Rating from -0.67 (Hollywood Pictures) to +1.13 (Republic Pictures).

* * *

## Part 5: Prediction

[Deadpool](https://www.imdb.com/title/tt1431045/), having an IMDb rating of 8.0, was an 108 minute long, Action & Adventure, Rated-R Feature Film released in 2016 by 20th Century Fox that has received 872,845 votes on IMDb and was never nominated for Best Picture (and hence, did not win, either). 

```{r, echo = FALSE}
#Deadpool data from https://www.imdb.com/title/tt1431045/.

deadpool <- data.frame("imdb_rating" = 8.0,
                       "genre" = "Action & Adventure",
                       "imdb_num_votes" = 872845,
                       "mpaa_rating" = "R",
                       "thtr_rel_year" = 2016,
                       "title_type" = "Feature Film",
                       "runtime" = 108,
                       "best_pic_nom" = "no",
                       "best_pic_win" = "no",
                       "studio" = "20th Century Fox")

#Prediction and Interval of Deadpool IMDb Rating from data.
predict(final_reg, deadpool, interval = "predict")
```

Our 95% prediction interval for the IMDb Rating of any movie that was an 108 minute long, Action & Adventure, Rated-R Feature Film released in 2016 by 20th Century Fox that has received 872,845 votes on IMDb and was never nominated for Best Picture (and hence, did not win, either) is between 6.84 and 10 (as 10 is the maximum score).  Deadpool, at 8.0, lies in this interval.

* * *

## Part 6: Conclusion

```{r, echo = FALSE}
#Final Regression R-squared.
print(paste("The R-squared value is", round(summary(final_reg)$r.squared, 4)))
```

This means that the final regression model of nine variables to predict the IMDb Rating only explains about 50% of the variability in the IMDb Rating.

I have already mentioned reservations about the sampling, as well as how different genre types are not mutually exclusive for a movie.  In addition, I purposely excluded actors and actresses from the model due to the complexity, but I think they would affect the rating, as people can be biased towards favorites and rate them higher.

I think directors could possibly influence rating, but more data per director would have to be available.

Box Office Earnings could possibly influence rating.  That metric was not included in the original dataset.

It is important to note none of these variables have been shown to be causal in affecting the IMDb rating.  We can only predict an interval of ratings based on the characterstics of the movie that have been shown to show trends from our reduced sample of 555 movies.

The dataset data is also not static, it is dynamic.  For example, take Django Unchained, the movie with the highest number of votes in the dataset.

```{r, echo = FALSE}
#Dataset data for Django Unchained.
data.frame(movies %>% filter(title == "Django Unchained") %>% select(title, imdb_rating, imdb_num_votes))
```

In reality, [Django Unchained](https://www.imdb.com/title/tt1853728/) has a rating of 8.4 by over 1,299,000 votes, as new votes regularly happen on IMDb, even for older movies.  The final project dataset, like many other aspects of this course, has not been updated.

* * *

# Appendix

All code for each Part is included here.

## Setup

```{r, eval = FALSE}
knitr::opts_chunk$set(comment = NA)
options("scipen" = 100)

years <- c(1970, 1975, 1980, 1985, 1990, 1995, 2000, 2005, 2010)
```

### Load packages

```{r, eval = FALSE}
library(dplyr)
library(ggplot2)
library(ggpubr)
library(grid)
library(gridExtra)
library(lemon)
library(lindia)
library(scales)
library(statsr)
library(viridis)
```

### Load data

```{r, eval = FALSE}
load("movies.Rdata")
```

* * *

## Part 1: Data

Plot : Distribution by Year of 651 Randomly Sampled Movies
```{r, eval = FALSE}
#Histogram.
sample_length <- max(thtr_rel_year) - min(thtr_rel_year) + 1
g1 <- ggplot(movies, aes(x = thtr_rel_year, fill = cut(thtr_rel_year, sample_length)))
g1 <- g1 + geom_histogram(bins = sample_length)
#Title.
g1 <- g1 + ggtitle(label = "Distribution by Year of 651 Randomly Sampled Movies")
#Viridis Color Scheme.
g1 <- g1 + scale_fill_viridis_d()
#X-axis.
g1 <- g1 + scale_x_continuous(name = "Theatrical Release Year",
                              breaks = years,
                              labels = years,
                              expand = c(0,0))
#Y-axis.
g1 <- g1 + scale_y_continuous(name = "Number of Movies")
                              
#Modify labels and text. Remove legend from left plot.
g1 <- g1 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                 axis.text.x = element_text(hjust = 1, size = 12, angle = 45),
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"),
                 legend.position = "none")
g1
```

Summary: Oscar Categories and Top 200 Boxoffice
 
```{r, eval = FALSE}
summary(movies %>%
          select(best_pic_nom,
                 best_pic_win,
                 best_actor_win,
                 best_actress_win,
                 best_dir_win,
                 top200_box))

```

* * *

## Part 2: Research question

* * *

## Part 3: Exploratory data analysis

Summary : Preliminary Model Variables

```{r, eval = FALSE}

movies_model <- movies %>% select(title, title_type, genre,
                                  runtime, mpaa_rating, studio,
                                  thtr_rel_year, thtr_rel_month,
                                  imdb_rating, imdb_num_votes,
                                  best_pic_nom, best_pic_win,
                                  best_actor_win, best_actress_win,
                                  top200_box, director)
summary(movies_model)
```

Plot : Distribution of Genres by Year of 651 Randomly Sampled Movies

```{r, eval = FALSE}
#Boxplot.
g2 <- ggplot(movies_model, aes(x = genre, y = thtr_rel_year))
g2 <- g2 + geom_boxplot(aes(color = genre), size = 1.3)
#Title.
g2 <- g2 + ggtitle(label = "Distribution of Genres by Year of 651 Randomly Sampled Movies")
#Viridis Color Scheme.
#X-axis.
g2 <- g2 + scale_x_discrete(name = "Genre",
                            expand = c(0,0))
#Y-axis.
g2 <- g2 + scale_y_continuous(name = "Theatrical Release Year")
#Modify labels and text. Remove legend from left plot.
g2 <- g2 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                 axis.text.x = element_text(hjust = 1, size = 10, angle = 45),
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"),
                 legend.position = "none")
g2
```

Summary:  IMDb Information by Year of 651 Randomly Sampled Movies

```{r, fig.height = 6, eval = FALSE}

summary(movies_model %>%
          select(imdb_num_votes,
                 imdb_rating))
```

Plot : IMDb Information by Year of 651 Randomly Sampled Movies

```{r, fig.height = 6, eval = FALSE}

#Scatter plot.
g3 <- ggplot(movies_model %>% filter(imdb_num_votes <= 100000), aes(x = imdb_num_votes, y = imdb_rating))
g3 <- g3 + geom_point(aes(color = thtr_rel_year), size = 5, alpha = 0.5)
#Title.
g3 <- g3 + ggtitle(label = "")
#Viridis Color Scheme.
g3 <- g3 + scale_color_viridis()
#X-axis.
g3 <- g3 + scale_x_continuous(name = "Number of Votes on IMDb",
                              labels = comma,
                              expand = c(0.005,0.005))
#Y-axis.
g3 <- g3 + scale_y_continuous(name = "Rating on IMDb",
                              limits = c(1.9, 9),
                              breaks = c(2, 4, 6, 8),
                              labels = c("2.0", "4.0", "6.0", "8.0"))
#Modify labels and text. Remove legend from left plot.
g3 <- g3 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                 axis.text.x = element_text(hjust = 1, size = 12, angle = 45),
                 axis.title.x = element_text(hjust = 1, size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"),
                 legend.position = "none")


g4 <- ggplot(movies_model %>% filter(imdb_num_votes >= 100000), aes(x = imdb_num_votes, y = imdb_rating))
g4 <- g4 + geom_point(aes(color = thtr_rel_year), size = 5, alpha = 0.5)
#Title.
g4 <- g4  + ggtitle(label = "IMDb Information by Year of 651 Randomly Sampled Movies")
#Viridis Color Scheme.
g4 <- g4  + scale_color_viridis(name = "Theatrical Release Year",
                                limits = c(1970, 2014),
                                breaks = c(1975, 1985, 1995, 2005))
g4 <- g4 + guides(color = guide_colorbar(title.position = "top"))
#X-axis.
g4 <- g4  + scale_x_continuous(name = "",
                              labels = comma,
                              expand = c(0,0)) 
#Y-axis.
g4 <- g4 + scale_y_continuous(name = "", position = "right",
                              limits = c(5, 9.3),
                              breaks = c(6, 8),
                              labels = c("6.0", "8.0"),
                              expand = c(0,0))
#Modify labels and text. Remove legend from left plot.
g4 <- g4  + theme(plot.title = element_text(hjust = 1.25, size = 16, face = "bold"),
                  axis.text.x = element_text(hjust = 1, size = 12, angle = 45),
                  axis.title.x = element_blank(),
                  axis.text.y = element_text(size = 12),
                  axis.title.y = element_blank())
                 

#Modify legend text.  Save as object.
legend3 <- g_legend(g4 + theme(legend.text = element_text(size = 12),
                               legend.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                               legend.key.width = unit(1.5, "cm"),
                               legend.position = "bottom"))
#Remove legend from right plot.
g4 <- g4 + theme(legend.position = "none")
#Arrange left plot, right plot, and legend on the bottom.
grid.arrange(g3, g4, legend3, layout_matrix = matrix(rbind(c(1, 1, 1, 2, 2),
                                                           c(1, 1, 1, 2, 2),
                                                           c(1, 1, 1, 2, 2),
                                                           c(1, 1, 1, 2, 2),
                                                           c(1, 1, 1, 2, 2),
                                                           c(1, 1, 1, NA, NA),
                                                           c(1, 1, 1, 3, 3),
                                                           c(1, 1, 1, NA, NA)),
                                                     ncol = 5))
```

Plot : Distribution of 651 Movies by Studio and Distribution of 651 Movies by Director

```{r, fig.height = 4, eval = FALSE, warning = FALSE}
#Studio Tally.
studio_df <- data.frame(movies_model %>% group_by(studio) %>% tally())

#Distribution of Movies by Studio.
g5 <- ggplot(studio_df, aes(x = n)) + geom_histogram(bins = 37, fill = viridis(4)[2])
#Title.
g5 <- g5 + ggtitle("Distribution of 651 Movies by Studio")
#X-axis
g5 <- g5 + scale_x_continuous("Number of Movies by Studio")
#Y-axis.
g5 <- g5 + scale_y_continuous(name = "Frequency of Studios")
#Modify labels and text.
g5 <- g5 + theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                 axis.text.x = element_text(size = 12),
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"))

#Director Tally.
director_df <- data.frame(movies_model %>% group_by(director) %>% tally())

#Distribution of Movies by Director.
g6 <-  ggplot(director_df, aes(x = n)) + geom_histogram(bins = 4, fill = viridis(4)[3])
#Title.
g6 <- g6 + ggtitle("Distribution of 651 Movies by Director")
#X-axis
g6 <- g6 + scale_x_continuous("Number of Movies by Director")
#Y-axis.
g6 <- g6 + scale_y_continuous(name = "Frequency of Directors")
#Modify labels and text.
g6 <- g6 + theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                 axis.text.x = element_text(size = 12),
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"))

grid.arrange(g6, g5, layout_matrix = matrix(rbind(c(1, 1, 1, 1, 1, 1, NA, 2, 2, 2, 2, 2, 2)),
                                            ncol = 13))
```

Ouput : 20th Century Fox names.

```{r, eval = FALSE}
movies_model$studio <- as.character(movies_model$studio)

#20th Century Fox Output.
unique(movies_model[grepl("Fox", movies_model$studio),]$studio)
```

Cleaning : Consolidating Similar Studio Names.

```{r, fig.height = 4,  eval = FALSE}
#Studios with repeats.
studios <- c("A24", "Anchor Bay", "Buena Vista", "Embassy", "Gravitas", "HBO", "IFC",
             "Indomina", "Miramax", "National Geographic", "New Line", "Newmarket", "Nordisk",
             "Orion", "Paramount", "Roadside", "Sony", "Touchstone",
             "Trimark", "Universal", "Weinstein")

for (studio_n in studios) {
  movies_model[grepl(studio_n, movies_model$studio),]$studio <- studio_n
}

#Disney/Walt Disney, DreamWorks, 20th Century Fox, LionsGate, MagnetMagnolia, MGM, Warner
movies_model[grepl("Columbia|TriStar", movies_model$studio),]$studio <- "Columbia Tristar Pictures"
movies_model[grepl("Disney", movies_model$studio),]$studio <- "Walt Disney"
movies_model[grepl("Dream", movies_model$studio),]$studio <- "DreamWorks"
movies_model[grepl("Fox", movies_model$studio),]$studio <- "20th Century Fox"
movies_model[grepl("Lions", movies_model$studio),]$studio <- "LionsGate"
movies_model[grepl("Magnet|Magnolia", movies_model$studio),]$studio <- "Magnolia Pictures"
movies_model[grepl("Goldwyn|MGM|UA|United Artists", movies_model$studio),]$studio <- "MGM/UA"
movies_model[grepl("Warner|WARNER", movies_model$studio),]$studio <- "Warner Brothers"

#New Studio Tally and filter.
studio_df <- data.frame(movies_model %>%
                          filter(!(is.na(studio)))  %>%
                          group_by(studio) %>%
                          tally()) %>%
  mutate(studio = as.factor(studio)) %>%
  filter(n >= 2)
```

Plots : Distribution of 555 Movies by Studio

```{r, fig.height = 4,  eval = FALSE}
#Distribution of Movies by Studio.
g7 <- ggplot(studio_df, aes(x = n)) + geom_histogram(bins = 70, fill = viridis(4)[2])
#Title.
g7 <- g7 + ggtitle("")
#X-axis
g7 <- g7 + scale_x_continuous("")
#Y-axis.
g7 <- g7 + scale_y_continuous(name = "Frequency of Studios")
#Modify labels and text.
g7 <- g7 + theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                 axis.text.x = element_text(size = 12),
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"))

#Distribution of Movies by Studio.
g8 <- ggplot(studio_df %>% filter(n > 15), aes(x = n, y = reorder(studio, n)))
g8 <- g8 + geom_bar(stat = "identity", fill = viridis(4)[1], orientation = "y")
#Title.
g8 <- g8 + ggtitle(paste("Distribution of", sum(studio_df$n), "Movies by Studio"))
#X-axis
g8 <- g8 + scale_x_continuous(name = "Number of Movies by Studio")
#Y-axis.
#g8 <- g8 + scale_y_discrete("Studios")
#Modify labels and text.
g8 <- g8 + theme(plot.title = element_text(hjust = -2.9, size = 14, face = "bold"),
                 axis.text.x = element_text(size = 12), 
                 axis.title.x = element_text(hjust = -1.25, size = 14, face = "bold"),
                 axis.text.y = element_text(hjust = 1, size = 12, angle = 25),
                 axis.title.y = element_blank())

grid.arrange(g7, g8, layout_matrix = matrix(rbind(c(1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2)),
                                            ncol = 13))

```

* * *

## Part 4: Modeling

### Variables for Model:

Output : Current Predictors

```{r, eval = FALSE}
movies_model <- movies_model %>%
  filter(studio %in% studio_df$studio) %>%
  select(c(9, 2:8, 10:15))

colnames(movies_model)[2:13]
```

```{r, eval = FALSE}
#Regression model with all preliminary variables.
prelim_reg <-summary(lm(imdb_rating ~ title_type + genre + runtime + mpaa_rating + thtr_rel_year
                        + thtr_rel_month + studio + imdb_num_votes + best_pic_nom + best_pic_win
                        + best_actor_win + best_actress_win + top200_box + studio,
                        data = movies_model))

#R-Squared.
ars <- round(prelim_reg$adj.r.squared, 4)
#F-Statistic
fstat <- prelim_reg$fstatistic
#p-Value.
pVal <- round(pf(fstat[1], fstat[2], fstat[3], lower.tail = FALSE), 4)

print(paste("The Adjusted R-Squared from the above variables is", ars, "."))
print(paste("The F-Statistic from the above variables is", round(fstat[1], 1), "."))
print(paste("The p-Value from the above F-Statistic on",
            round(fstat[2], 1), "and",
            round(fstat[3], 1), "degrees of freedom is ~", pVal, "."))
```

Summary: Full Preliminary Model

```{r}
prelim_reg
```

### Model Selection Process:

Select the first variable that has the highest adjusted R<sup>2</sup>.

```{r, message = FALSE, eval = FALSE}
#Selection 1.
Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(2:14)]) {
  Predictors <- c(Predictors, x)
  temp_df <- movies_model %>%
    select(imdb_rating, x) %>%
    `colnames<-`(c("imdb_rating", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

Select the second variable, combined with the developing model, that has the highest adjusted R<sup>2</sup>.

```{r, eval = FALSE}
#Selection 2.
movies_model <- movies_model %>%
  select(1, 3, 2, 4:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(3:14)]) {
  Predictors <- c(Predictors, paste("genre + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

Select the third variable, combined with the developing model, that has the highest adjusted R<sup>2</sup>.

```{r, eval = FALSE}
#Selection 3.
movies_model <- movies_model %>%
  select(1, 2, 9, 3:8, 10:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(4:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

Select the fourth variable, combined with the developing model, that has the highest adjusted R<sup>2</sup>.

```{r, eval = FALSE}
#Selection 4.
movies_model <- movies_model %>%
  select(1:3, 6, 4, 5, 7:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(5:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

Select the fifth variable, combined with the developing model, that has the highest adjusted R<sup>2</sup>.

```{r, eval = FALSE}
#Selection 5.
movies_model <- movies_model %>%
  select(1:4, 8, 5:7, 9:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(6:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year" , "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

Select the sixth variable, combined with the developing model, that has the highest adjusted R<sup>2</sup>.

```{r, eval = FALSE}
#Selection 6.
#No change in order.

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(7:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, title_type,
           x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year", "title_type",
                   "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type +
                         depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

Select the seventh variable, combined with the developing model, that has the highest adjusted R<sup>2</sup>.

```{r, eval = FALSE}
#Selection 7.
#No change in order.

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(8:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, title_type,
           runtime, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year", "title_type",
                   "runtime", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type +
                         runtime + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

Select the eighth variable, combined with the developing model, that has the highest adjusted R<sup>2</sup>.

```{r, eval = FALSE}
#Selection 8.
movies_model <- movies_model %>%
  select(1:7, 10, 8, 9, 11:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(9:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, title_type,
           runtime, best_pic_nom, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year", "title_type",
                   "runtime", "best_pic_nom", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type +
                         runtime + best_pic_nom + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

Select the ninth variable, combined with the developing model, that has the highest adjusted R<sup>2</sup>.

```{r, eval = FALSE}
#Selection 9.
movies_model <- movies_model %>%
  select(1:8, 11, 9, 10, 12:14)

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(10:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, title_type,
           runtime, best_pic_nom, best_pic_win, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year", "title_type",
                   "runtime", "best_pic_nom", "best_pic_win", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type +
                         runtime + best_pic_nom + best_pic_win + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

Show that no additional variable, combined with the developing model, increases the adjusted R<sup>2</sup>.

```{r, eval = FALSE}
#Selection 10.
#No change in order.

Predictors <- NULL
R2 <- NULL
for (x in colnames(movies_model)[c(11:14)]) {
  Predictors <- c(Predictors, paste("selected explanatory variables + ", x))
  temp_df <- movies_model %>%
    select(imdb_rating, genre, imdb_num_votes, mpaa_rating, thtr_rel_year, title_type,
           runtime, best_pic_nom, best_pic_win, studio, x) %>%
    `colnames<-`(c("imdb_rating", "genre", "imdb_num_votes", "mpaa_rating", "thtr_rel_year", "title_type",
                   "runtime", "best_pic_nom", "best_pic_win", "studio", "depen"))
  new_R2 <- summary(lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type +
                         runtime + best_pic_nom + best_pic_win + studio + depen,
                       data = temp_df))$adj.r.squared
  R2 <- c(R2, new_R2)
}

R2_values <- data.frame("Predictor_Variables" = Predictors, "Adjusted_R2" = R2)
R2_values
```

### Model diagnostics

#### Linear Relationships Between x and y

Plots: Residual vs IMDB Number of Votes, Residual vs Theatrical Release Year, and Residual vs Runtime

```{r, message = FALSE, eval = FALSE}
final_model <- movies_model %>%
  select(1:10)

#Regression Model.
final_reg <- lm(imdb_rating ~ genre + imdb_num_votes + mpaa_rating + thtr_rel_year + title_type
                + runtime + best_pic_nom + best_pic_win + studio,
                data = movies_model)

#Scatter of Residual Values vs IMDB Number of Votes.
g9 <- ggplot(final_reg, aes(x = imdb_num_votes, y = .resid))
g9 <- g9 + geom_point(color = viridis(5)[3], size = 3, alpha = 0.2)
#Horizontal line at y = 0.
g9 <- g9 + geom_hline(yintercept = 0, col = viridis(5)[1], linetype = "dashed")
#Title.
g9 <- g9 + ggtitle("Residual Values vs Votes")
#X-axis & Y-axis.
g9 <- g9 + scale_x_continuous("IMDB Number of Votes", labels = comma) + ylab("Residual Value")
#Modify labels and text.
g9 <- g9 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                 axis.text.x = element_text(size = 12), 
                 axis.title.x = element_text(size = 14, face = "bold"),
                 axis.text.y = element_text(size = 12),
                 axis.title.y = element_text(size = 14, face = "bold"))

#Scatter of Residual Values vs Theatrical Release Year.
g10 <- ggplot(final_reg, aes(x = thtr_rel_year , y = .resid))
g10 <- g10 + geom_point(color = viridis(5)[3], size = 3, alpha = 0.2)
#Horizontal line at y = 0.
g10 <- g10 + geom_hline(yintercept = 0, col = viridis(5)[1], linetype = "dashed")
#Title.
g10 <- g10 + ggtitle("Residual Values vs Year")
#X-axis & Y-axis.
g10 <- g10 + xlab("Theatrical Release Year") + ylab("Residual Value")
#Modify labels and text.
g10 <- g10 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                  axis.text.x = element_text(size = 12), 
                  axis.title.x = element_text(size = 14, face = "bold"),
                  axis.text.y = element_text(size = 12),
                  axis.title.y = element_text(size = 14, face = "bold"))

#Scatter of Residual Values vs Runtime of Movie.
g11 <- ggplot(final_reg, aes(x = runtime, y = .resid))
g11 <- g11 + geom_point(color = viridis(5)[3], size = 3, alpha = 0.2)
#Horizontal line at y = 0.
g11 <- g11 + geom_hline(yintercept = 0, col = viridis(5)[1], linetype = "dashed")
#Title.
g11 <- g11 + ggtitle("Residual Values vs Runtime")
#X-axis & Y-axis.
g11 <- g11 + xlab("Runtime of Movie (minutes)") + ylab("Residual Value")
#Modify labels and text.
g11 <- g11 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                  axis.text.x = element_text(size = 12), 
                  axis.title.x = element_text(size = 14, face = "bold"),
                  axis.text.y = element_text(size = 12),
                  axis.title.y = element_text(size = 14, face = "bold"))

grid.arrange(g9, g10, g11, layout_matrix = matrix(rbind(c(1, 1, 2, 2),
                                                        c(NA, 3, 3, NA)),
                                                  ncol = 4))
```

#### Nearly Normal Residuals

Plots : Distribution of Residual Values and Normal-QQ

```{r, fig.height = 4, message = FALSE, eval = FALSE}
#Histogram
g12 <- ggplot(mapping = aes(x = final_reg$residuals)) + geom_histogram(bins = 20, fill = viridis(5)[3])
#Title.
g12 <- g12 + ggtitle("Distribution of Residual Values")
#X-axis & Y-axis.
g12 <- g12 + xlab("Residual Value") + ylab("Frequency")
#Modify labels and text.
g12 <- g12 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                   axis.text.x = element_text(size = 12), 
                   axis.title.x = element_text(size = 14, face = "bold"),
                   axis.text.y = element_text(size = 12),
                   axis.title.y = element_text(size = 14, face = "bold"))

#QQLine
res = final_reg$residuals
m = (quantile(res, 0.75) - quantile(res, 0.25)) / (qnorm(0.75) - qnorm(0.25))
b = quantile(res, .25) - m * qnorm(0.25)
qq_line = data.frame(intercept = b,
                     slope = m)

#Normal-QQ Plot
g13 <- ggplot(data = final_reg)
g13 <- g13 + stat_qq(aes(sample = res), color = viridis(5)[3], size = 3, alpha = 0.4)
g13 <- g13 + geom_abline(data = qq_line ,aes(intercept = b, slope = m), color = viridis(5)[1], size = 1)
#Title.
g13 <- g13 + ggtitle("Normal-QQ Plot")
#X-axis & Y-axis.
g13 <- g13 + xlab("Theoretical Quantile") + ylab("Standardized Residual")
#Modify labels and text.
g13 <- g13 + theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
                   axis.text.x = element_text(size = 12), 
                   axis.title.x = element_text(size = 14, face = "bold"),
                   axis.text.y = element_text(size = 12),
                   axis.title.y = element_text(size = 14, face = "bold"))

grid.arrange(g12, g13, layout_matrix = matrix(c(1, 2),
                                              ncol = 2))
```

#### Constant Variability of Residuals

Plots : Residual vs Fitted Values and Absolute Value of Residuals vs Fitted Values

```{r, fig.height = 4, message = FALSE, eval = FALSE}
#Scatter of Residuals vs. Fitted.
g14 <- ggplot(final_reg, aes(x = .fitted, y = .resid))
g14 <- g14 + geom_point(color = viridis(5)[3], size = 3, alpha = 0.4)
##Horizontal Line.
g14 <- g14 + geom_hline(yintercept = 0, col = viridis(5)[1], linetype = "dashed")
#Title.
g14 <- g14 + ggtitle("Residual vs Fitted Values")
#X-axis & Y-axis.
g14 <- g14 + xlab("Fitted Value") + ylab("Residual Value")
#Modify labels and text.
g14 <- g14 + theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                   axis.text.x = element_text(size = 12), 
                   axis.title.x = element_text(size = 14, face = "bold"),
                   axis.text.y = element_text(size = 12),
                   axis.title.y = element_text(size = 14, face = "bold"))

#Scatter of Absolute Value of Residuals vs. Fitted.
g15 <- ggplot(final_reg, aes(x = .fitted, y = abs(.resid)))
g15 <- g15 + geom_point(color = viridis(5)[3], size = 3, alpha = 0.4)
##Horizontal Line.
g15 <- g15 + geom_hline(yintercept = 0, col = viridis(5)[1], linetype = "dashed")
#Title.
g15 <- g15 + ggtitle("Absolute Value of Residuals vs Fitted Values")
#X-axis & Y-axis.
g15 <- g15 + xlab("Fitted Value") + ylab("Absolute Value of Residual")
#Modify labels and text.
g15 <- g15 + theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
                   axis.text.x = element_text(size = 12), 
                   axis.title.x = element_text(size = 14, face = "bold"),
                   axis.text.y = element_text(size = 12),
                   axis.title.y = element_text(size = 14, face = "bold"))

grid.arrange(g14, g15, layout_matrix = matrix(c(1, 2),
                                              ncol = 2))
```

### Interpretation of Model Coefficients

Output : Final Regression Model

```{r}
summary(final_reg)
```

* * *

## Part 5 : Prediction

```{r, eval = FALSE}
#Deadpool data from https://www.imdb.com/title/tt1431045/.
deadpool <- data.frame("imdb_rating" = 8.0,
                       "genre" = "Action & Adventure",
                       "imdb_num_votes" = 872845,
                       "mpaa_rating" = "R",
                       "thtr_rel_year" = 2016,
                       "title_type" = "Feature Film",
                       "runtime" = 108,
                       "best_pic_nom" = "no",
                       "best_pic_win" = "no",
                       "studio" = "20th Century Fox")

#Prediction and Interval of Deadpool IMDb Rating from data.
predict(final_reg, deadpool, interval = "predict")
```

* * *

## Part 6 : Conclusion

```{r, eval = FALSE}
#Final Regression R-squared.
print(paste("The R-squared value is", round(summary(final_reg)$r.squared, 4)))

#Dataset data for Django Unchained.
data.frame(movies %>% filter(title == "Django Unchained") %>% select(title, imdb_rating, imdb_num_votes))
```

* * *